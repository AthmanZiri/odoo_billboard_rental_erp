<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Artwork History Actions -->
    <record id="action_media_artwork_billboard" model="ir.actions.act_window">
        <field name="name">Billboard Artwork</field>
        <field name="res_model">media.artwork.history</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('site_category', '=', 'billboard')]</field>
        <field name="context">{'default_site_category': 'billboard'}</field>
    </record>

    <record id="action_media_artwork_canopy" model="ir.actions.act_window">
        <field name="name">Canopy Artwork</field>
        <field name="res_model">media.artwork.history</field>
        <field name="view_mode" >list,form</field>
        <field name="domain">[('site_category', '=', 'canopy')]</field>
        <field name="context">{'default_site_category': 'canopy'}</field>
    </record>

    <!-- Artwork History List View -->
    <record id="view_media_artwork_history_list" model="ir.ui.view">
        <field name="name">media.artwork.history.list</field>
        <field name="model">media.artwork.history</field>
        <field name="arch" type="xml">
            <list string="Artwork History">
                <field name="upload_date" string="Date"/>
                <field name="artwork_file" widget="image" options="{'size': [64, 64]}"/>
                <field name="partner_id" string="Client"/>
                <field name="site_id" string="Site/Canopy"/>
                <field name="face_id" string="Face" optional="hide" invisible="site_category == 'canopy'"/>
                <field name="site_category" invisible="1"/>
                <field name="uploaded_by"/>
            </list>
        </field>
    </record>

    <!-- Artwork History Form View (Simplified) -->
    <record id="view_media_artwork_history_form" model="ir.ui.view">
        <field name="name">media.artwork.history.form</field>
        <field name="model">media.artwork.history</field>
        <field name="arch" type="xml">
            <form string="Artwork History">
                <sheet>
                    <group>
                        <group name="identity_info">
                            <field name="site_category" invisible="1"/>
                            
                            <!-- Canopy: Just show 'Canopy' -->
                            <field name="site_id" string="Canopy" 
                                   invisible="site_category != 'canopy'"
                                   domain="[('site_category', '=', 'canopy')]"
                                   options="{'no_create': True}"
                                   required="site_category == 'canopy'"/>
                            
                            <!-- Billboard: Show Site and Face -->
                            <field name="site_id" string="Site" 
                                   invisible="site_category == 'canopy'"
                                   domain="[('site_category', '=', 'billboard')]"
                                   options="{'no_create': True}"
                                   required="site_category != 'canopy'"/>
                            <field name="face_id" string="Face" 
                                   invisible="site_category == 'canopy'"
                                   domain="[('site_id', '=', site_id)]"
                                   options="{'no_create': True}"
                                   required="site_category != 'canopy'"/>
                            
                            <!-- Hidden Face field for Canopies (Auto-populated by model) -->
                            <field name="face_id" invisible="1" force_save="1" required="0"/>

                            <field name="sale_order_line_id" 
                                   string="Contract Line"
                                   domain="[('media_face_id', '=', face_id)]"
                                   options="{'no_create': True}"/>
                        </group>
                        <group name="metadata">
                            <field name="partner_id" string="Client" readonly="1" force_save="1"/>
                            <field name="upload_date" readonly="1"/>
                            <field name="uploaded_by" readonly="1"/>
                        </group>
                    </group>
                    <group string="Artwork Content">
                        <field name="artwork_file" widget="image" options="{'zoom': true}"/>
                        <field name="description" placeholder="Optional notes..."/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Temporarily removed search view to fix ParseError blocker -->
</odoo>
